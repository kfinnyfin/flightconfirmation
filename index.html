<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Client Portal | Signature Elite Aviation</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,400;0,500;0,600;1,400&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Leaflet Maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <style>
        /* -----------------------------------------------------------
           1. CORE VARIABLES & RESET
           ----------------------------------------------------------- */
        :root {
            /* Palette - Lux Dark Mode (Default) */
            --bg-deep: #0a0a0a;
            --bg-panel: #141414;
            --primary-gold: #C5A059;
            --primary-gold-dim: #6d5831;
            --text-main: #f0f0f0;
            --text-muted: #888888;
            --border-color: rgba(255, 255, 255, 0.08);
            --accent-blue: #2E86AB; /* For Yacht Mode */
            --water-blue: #0f1e29;
            
            /* UI Elements */
            --glass-bg: rgba(20, 20, 20, 0.9);
            --radius-lg: 16px;
            --radius-sm: 6px;
            
            --nav-width: 90px;
            --header-height: 80px;
        }

        /* LIGHT MODE - "Oyster" Theme */
        [data-theme="light"] {
            --bg-deep: #f4f1ea; 
            --bg-panel: #ffffff;
            --primary-gold: #A68A48; 
            --primary-gold-dim: #D4AF37;
            --text-main: #2c2c2c;
            --text-muted: #6e6e6e;
            --border-color: rgba(0, 0, 0, 0.08);
            --glass-bg: rgba(255, 255, 255, 0.85);
            --water-blue: #d4eaf7;
        }

        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        
        body, html {
            margin: 0; padding: 0; width: 100%; height: 100%;
            font-family: 'Manrope', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-main);
            overflow: hidden;
            transition: background-color 0.4s ease, color 0.4s ease;
        }

        h1, h2, h3 { 
            font-family: 'Playfair Display', serif; 
            font-weight: 400; 
            margin: 0; 
            letter-spacing: -0.02em;
        }
        
        .uppercase-label {
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--primary-gold);
            margin-bottom: 8px;
        }

        /* -----------------------------------------------------------
           2. LAYOUT & HELPERS
           ----------------------------------------------------------- */
        #app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
            width: 100vw;
            background: var(--bg-deep);
        }
        
        /* Leg Switcher */
        .leg-switcher {
            display: flex;
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            border-radius: 30px;
            padding: 4px;
            margin-top: 10px;
        }
        .leg-btn {
            padding: 8px 16px;
            border-radius: 25px;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            color: var(--text-muted);
            transition: 0.3s;
            display: flex; align-items: center; gap: 6px;
        }
        .leg-btn.active {
            background: var(--primary-gold);
            color: #121212;
            box-shadow: 0 2px 10px rgba(197, 160, 89, 0.3);
        }

        /* Content Visibility Classes (Strict Mode) */
        .show-jet { display: block; }
        .show-yacht { display: none !important; }
        .show-yacht-flex { display: none !important; }
        
        /* Yacht Mode Active */
        body.mode-yacht .show-jet { display: none !important; }
        body.mode-yacht .show-yacht { display: block !important; }
        body.mode-yacht .show-yacht-flex { display: flex !important; }
        body.mode-yacht .show-jet-flex { display: none !important; }

        /* Flexbox Helpers */
        .show-jet-flex { display: flex; }

        /* Sidebar (Mobile Bottom Nav) */
        .sidebar {
            order: 3;
            height: 80px;
            width: 100%;
            background: var(--glass-bg);
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-evenly;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(15px);
            padding-bottom: env(safe-area-inset-bottom);
        }
        
        .brand-logo { display: none; }
        
        .nav-item {
            width: 60px; height: 100%;
            display: flex; justify-content: center; align-items: center;
            color: var(--text-muted);
            font-size: 1.3rem;
            transition: 0.3s;
            position: relative;
        }
        .nav-item.active { color: var(--primary-gold); }
        .nav-item.active::after {
            content: ''; position: absolute; top: 0; left: 50%; transform: translateX(-50%);
            width: 30px; height: 3px; background: var(--primary-gold);
            border-radius: 0 0 4px 4px;
        }

        /* Header */
        .top-header {
            order: 1;
            height: auto; min-height: 80px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 15px 25px;
            background: transparent;
            z-index: 100;
            padding-top: max(15px, env(safe-area-inset-top));
        }
        .top-header h2 { font-size: 1.25rem; color: var(--text-main); }
        .top-header .sub-text { font-size: 0.8rem; color: var(--text-muted); margin-top: 2px; }
        
        .countdown-timer {
            font-family: 'Manrope', monospace;
            font-weight: 600;
            color: var(--primary-gold);
            font-size: 0.75rem;
            letter-spacing: 0.05em;
            border: 1px solid var(--border-color);
            padding: 6px 12px;
            border-radius: 30px;
            display: none;
        }

        /* Main View */
        #view-container {
            order: 2; flex: 1;
            padding: 10px 25px 40px 25px;
            overflow-y: auto; scroll-behavior: smooth;
        }

        .view-section { display: none; animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1); }
        .view-section.active-view { display: block; }
        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Grid System */
        .dashboard-grid { display: flex; flex-direction: column; gap: 25px; }

        /* Cards */
        .card {
            background: var(--bg-panel);
            border: 1px solid var(--border-color);
            border-radius: var(--radius-lg);
            padding: 25px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.02);
            position: relative;
            overflow: hidden;
        }

        /* Map */
        #map-container {
            width: 100%; height: 320px;
            border-radius: var(--radius-lg);
            z-index: 1;
            filter: grayscale(20%) contrast(110%);
            transition: filter 0.5s ease;
        }
        body.mode-yacht #map-container {
            filter: contrast(110%) hue-rotate(10deg) saturate(1.2); 
        }
        .leaflet-container { background: var(--bg-panel); font-family: 'Manrope'; }
        
        /* -----------------------------------------------------------
           3. MODELS & PLANS
           ----------------------------------------------------------- */
        .blueprint-container {
            width: 100%; display: flex; justify-content: center;
            padding: 40px 0; overflow: visible; /* REVERTED from hidden/relative */
        }

        .fuselage-wrapper {
            position: relative; width: 320px; display: flex; justify-content: center;
            z-index: 2;
        }

        /* --- JET STYLES --- */
        .fuselage-shell {
            width: 200px; height: 800px;
            background: linear-gradient(90deg, #e0e0e0 0%, #ffffff 40%, #d4d4d4 100%);
            border-radius: 100px 100px 90px 90px;
            position: relative; z-index: 2;
            box-shadow: inset 10px 0 20px rgba(0,0,0,0.1), inset -10px 0 20px rgba(0,0,0,0.2), 0 20px 50px rgba(0,0,0,0.3);
            display: flex; flex-direction: column; overflow: hidden;
        }
        [data-theme="dark"] .fuselage-shell {
            background: linear-gradient(90deg, #2b2b2b 0%, #4a4a4a 40%, #222 100%);
            box-shadow: inset 5px 0 15px rgba(0,0,0,0.5), inset -5px 0 15px rgba(0,0,0,0.8), 0 20px 40px rgba(0,0,0,0.5);
        }

        /* --- YACHT STYLES --- */
        .yacht-shell {
            width: 180px; height: 700px;
            background: linear-gradient(180deg, #f0f0f0 0%, #ffffff 50%, #e0e0e0 100%);
            border-radius: 50% 50% 10px 10px / 120px 120px 10px 10px;
            position: relative; z-index: 10;
            box-shadow: 0 0 0 8px rgba(255,255,255,0.05), 0 20px 50px rgba(0,0,0,0.3);
            display: flex; flex-direction: column; overflow: hidden;
            border: 1px solid rgba(0,0,0,0.1);
            transition: box-shadow 0.3s ease;
        }
        [data-theme="dark"] .yacht-shell {
            background: linear-gradient(180deg, #1a2a3a 0%, #243b55 50%, #1a2a3a 100%);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .teak-deck {
            position: absolute; inset: 8px;
            border-radius: 50% 50% 5px 5px / 110px 110px 5px 5px;
            background: repeating-linear-gradient(90deg, rgba(139, 69, 19, 0.1), rgba(139, 69, 19, 0.1) 2px, transparent 2px, transparent 8px);
            z-index: 1; opacity: 0.5;
        }

        /* --- PARTS --- */
        .window-row-left, .window-row-right { position: absolute; top: 150px; bottom: 120px; width: 8px; display: flex; flex-direction: column; justify-content: space-between; z-index: 3; pointer-events: none; }
        .window-row-left { left: 8px; } .window-row-right { right: 8px; }
        .oval-window { width: 100%; height: 24px; background: #0a1a2a; border-radius: 50%; box-shadow: inset 1px 1px 2px rgba(255,255,255,0.2); }

        .wing { position: absolute; top: 400px; width: 180px; height: 300px; background: linear-gradient(135deg, #dcdcdc 0%, #f0f0f0 100%); z-index: 1; box-shadow: 0 10px 20px rgba(0,0,0,0.1); }
        [data-theme="dark"] .wing { background: linear-gradient(135deg, #333 0%, #444 100%); }
        .wing-left { left: -120px; transform: skewY(-20deg) rotate(-10deg); border-radius: 10px 0 0 80px; }
        .wing-right { right: -120px; transform: skewY(20deg) rotate(10deg); border-radius: 0 10px 80px 0; }

        .engine { position: absolute; bottom: 80px; width: 40px; height: 90px; background: linear-gradient(to right, #ccc, #fff, #ccc); border-radius: 20px 20px 10px 10px; z-index: 1; box-shadow: 5px 10px 15px rgba(0,0,0,0.2); }
        [data-theme="dark"] .engine { background: linear-gradient(to right, #222, #444, #222); }
        .engine-left { left: -30px; } .engine-right { right: -30px; }

        .stabilizer { position: absolute; bottom: 20px; width: 90px; height: 60px; background: #d4d4d4; z-index: 1; }
        [data-theme="dark"] .stabilizer { background: #3a3a3a; }
        .stab-left { left: -50px; transform: skewY(-30deg); border-radius: 5px 0 0 20px; }
        .stab-right { right: -50px; transform: skewY(30deg); border-radius: 0 5px 20px 0; }

        .cockpit-glass { height: 100px; width: 100%; display: flex; justify-content: center; align-items: flex-end; padding-bottom: 20px; }
        .windshield { width: 80%; height: 40px; background: linear-gradient(180deg, #1a2a3a 0%, #000 100%); border-radius: 40px 40px 10px 10px; border: 2px solid #888; }

        .interior-layout { flex: 1; padding: 20px; display: flex; flex-direction: column; position: relative; z-index: 5; }
        .zone { width: 100%; position: relative; }
        .zone-label { text-align: center; font-size: 0.6rem; letter-spacing: 2px; color: var(--text-muted); opacity: 0.7; margin: 10px 0; text-transform: uppercase; }

        .seat { width: 45px; height: 45px; background: var(--bg-deep); border: 1px solid var(--text-muted); border-radius: 8px; position: absolute; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 0.75rem; color: var(--text-main); box-shadow: 0 4px 6px rgba(0,0,0,0.1); transition: 0.2s; z-index: 10; }
        .seat:hover { border-color: var(--primary-gold); transform: scale(1.05); }
        .seat.assigned { background: var(--primary-gold); color: #1a1a1a; border-color: var(--primary-gold); font-weight: 700; }

        /* Jet Config */
        .zone-1 { height: 220px; } .zone-1 .s1 { top: 10px; left: 0; } .zone-1 .s2 { top: 10px; right: 0; } .zone-1 .s3 { bottom: 10px; left: 0; } .zone-1 .s4 { bottom: 10px; right: 0; }
        .zone-2 { height: 220px; } .zone-2 .s1 { top: 10px; left: 0; } .zone-2 .s2 { top: 70px; left: 0; }
        .table { position: absolute; top: 10px; right: 0; width: 60px; height: 100px; background: rgba(100,100,100,0.1); border: 1px solid var(--border-color); border-radius: 4px; display: flex; align-items: center; justify-content: center; font-size: 0.6rem; color: var(--text-muted); writing-mode: vertical-rl; }
        .credenza { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); width: 120px; height: 30px; background: rgba(100,100,100,0.1); border: 1px solid var(--border-color); }
        .zone-3 { height: 180px; } .divan { position: absolute; top: 10px; left: 0; width: 50px; height: 140px; background: rgba(100,100,100,0.1); border: 1px solid var(--border-color); border-radius: 4px; writing-mode: vertical-rl; display: flex; align-items: center; justify-content: center; font-size: 0.6rem; }
        .zone-3 .s1 { top: 20px; right: 0; } .zone-3 .s2 { bottom: 20px; right: 0; }

        /* Yacht Config */
        .deck-zone { position: relative; width: 100%; z-index: 2; }
        .bow-deck { height: 180px; position: relative; }
        .jacuzzi { position: absolute; top: 60px; left: 50%; transform: translateX(-50%); width: 60px; height: 60px; border-radius: 50%; background: rgba(46, 134, 171, 0.3); border: 2px solid rgba(46, 134, 171, 0.5); display: flex; align-items: center; justify-content: center; font-size: 0.5rem; color: var(--accent-blue); }
        .sunpad { position: absolute; top: 130px; left: 50%; transform: translateX(-50%); width: 100px; height: 30px; border-radius: 8px; background: rgba(255,255,255,0.1); border: 1px solid var(--border-color); }
        .mid-deck { height: 250px; position: relative; border-top: 1px dashed var(--border-color); }
        .dining-table-lg { position: absolute; top: 40px; left: 50%; transform: translateX(-50%); width: 80px; height: 100px; border-radius: 12px; border: 1px solid var(--primary-gold-dim); background: rgba(197, 160, 89, 0.1); display: flex; align-items: center; justify-content: center; font-size: 0.6rem; color: var(--primary-gold); writing-mode: vertical-rl; }
        .aft-deck { height: 200px; position: relative; border-top: 1px dashed var(--border-color); }
        .lounge-sofa { position: absolute; top: 30px; left: 20px; width: 30px; height: 120px; border-radius: 8px; border: 1px solid var(--text-muted); background: rgba(255,255,255,0.05); }
        .lounge-sofa.right { left: auto; right: 20px; }

        /* TOY BOX STYLES */
        .toy-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-top: 20px; }
        .toy-card { background: rgba(255,255,255,0.03); border: 1px solid var(--border-color); padding: 15px; border-radius: 8px; text-align: center; }
        .toy-icon { font-size: 1.5rem; color: var(--accent-blue); margin-bottom: 8px; }
        .toy-name { font-size: 0.8rem; color: var(--text-main); font-weight: 600; }
        .toy-sub { font-size: 0.65rem; color: var(--text-muted); margin-top: 4px; }

        /* -----------------------------------------------------------
           4. COMPONENTS
           ----------------------------------------------------------- */
        .jet-hero { width: 100%; height: 240px; background: url('https://assets.skiesmag.com/wp-content/uploads/2024/05/Gulfstream-G650-Program-Surpasses-1M-Flight-Hours.20240516.jpg') center/cover no-repeat; border-radius: var(--radius-sm); margin-bottom: 25px; position: relative; }
        
        .yacht-hero { 
            width: 100%; height: 240px; 
            background: url('https://images.northropandjohnson.com/yacht/SZelg5I4NC/631b6f7f552c3d55610ed439/img-f-vwrapuocbcwx.jpg?auto=format&w=1268&q=80') center/cover no-repeat; 
            border-radius: var(--radius-sm); margin-bottom: 25px; position: relative; 
        }
        
        .tail-number { position: absolute; top: 20px; right: 20px; background: rgba(0,0,0,0.6); backdrop-filter: blur(4px); padding: 5px 10px; border-radius: 4px; font-family: monospace; font-size: 1rem; color: #fff; border: 1px solid rgba(255,255,255,0.2); }

        .crew-row { display: flex; align-items: center; gap: 20px; padding: 15px 0; border-bottom: 1px solid var(--border-color); }
        .crew-row:last-child { border-bottom: none; }
        .crew-avatar { width: 48px; height: 48px; border-radius: 50%; background: #2a2a2a; color: var(--primary-gold); display: flex; align-items: center; justify-content: center; border: 1px solid var(--primary-gold-dim); font-size: 1.1rem; }

        .provisioning-group { margin-bottom: 35px; }
        .multi-select-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 15px; }
        .select-option { background: transparent; border: 1px solid var(--border-color); padding: 15px 16px; border-radius: 8px; font-size: 0.85rem; color: var(--text-main); cursor: pointer; transition: 0.2s; text-align: center; }
        .select-option:hover { border-color: var(--primary-gold-dim); background: rgba(128,128,128,0.05); }
        .select-option.selected { background: var(--primary-gold); color: #121212; border-color: var(--primary-gold); font-weight: 600; box-shadow: 0 4px 12px rgba(197, 160, 89, 0.3); }

        .env-controls { display: grid; grid-template-columns: 1fr; gap: 25px; margin-top: 30px; }
        .control-box { background: var(--bg-panel); padding: 25px; border-radius: var(--radius-lg); border: 1px solid var(--border-color); text-align: center; }
        .control-label { margin-bottom: 20px; font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; }
        
        .mood-grid { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin-bottom: 10px; }
        .mood-btn { width: 35px; height: 35px; border-radius: 50%; cursor: pointer; border: 2px solid var(--bg-panel); box-shadow: 0 4px 10px rgba(0,0,0,0.2); transition: 0.3s; }
        .mood-btn:hover { transform: translateY(-3px); }
        .mood-btn.selected { transform: scale(1.15); border-color: var(--text-main); }

        .timeline-item { display: flex; gap: 20px; margin-bottom: 35px; position: relative; }
        .timeline-item::before { content: ''; position: absolute; left: 7px; top: 25px; bottom: -40px; width: 1px; background: var(--border-color); }
        .timeline-item:last-child::before { display: none; }
        .timeline-dot { width: 16px; height: 16px; border-radius: 50%; background: var(--bg-panel); border: 2px solid var(--primary-gold); margin-top: 5px; flex-shrink: 0; z-index: 2; }
        .timeline-time { font-family: 'Manrope'; font-weight: 700; color: var(--primary-gold); font-size: 0.9rem; margin-bottom: 4px; }
        .timeline-title { font-size: 1.1rem; font-weight: 400; font-family: 'Playfair Display'; margin-bottom: 4px; }
        .timeline-sub { font-size: 0.8rem; color: var(--text-muted); }

        #passenger-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 2000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(8px); }
        .modal-content { background: var(--bg-panel); padding: 40px; border-radius: var(--radius-lg); width: 85%; max-width: 400px; border: 1px solid var(--primary-gold); text-align: center; color: var(--text-main); box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .modal-input { width: 100%; padding: 16px; margin: 20px 0; background: transparent; border: 1px solid var(--border-color); color: var(--text-main); border-radius: 8px; font-family: 'Manrope'; font-size: 1rem; text-align: center; }
        .modal-btn { background: var(--primary-gold); border: none; padding: 14px 30px; color: #121212; font-weight: 600; border-radius: 30px; cursor: pointer; letter-spacing: 0.5px; transition: 0.2s; }
        .modal-btn:hover { background: #fff; }

        /* -----------------------------------------------------------
           5. DESKTOP OVERRIDES
           ----------------------------------------------------------- */
        @media (min-width: 1024px) {
            #app-container { display: grid; grid-template-columns: 110px 1fr; grid-template-rows: 90px 1fr; }
            .sidebar { order: unset; grid-row: 1 / -1; grid-column: 1; height: 100%; width: 100%; border-top: none; border-right: 1px solid var(--border-color); flex-direction: column; justify-content: flex-start; padding-top: 40px; padding-bottom: 0; }
            .brand-logo { display: block; margin-bottom: 60px; font-size: 2rem; color: var(--primary-gold); }
            .nav-item { width: 60px; height: 60px; margin-bottom: 30px; }
            .nav-item.active::after { width: 3px; height: 30px; left: 0; top: 50%; transform: translateY(-50%); border-radius: 0 4px 4px 0; }
            .top-header { order: unset; grid-column: 2; grid-row: 1; height: 100%; padding: 0 50px; }
            #view-container { order: unset; grid-column: 2; grid-row: 2; padding: 40px 50px; }
            .dashboard-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 30px; }
            #map-container { height: 450px; }
            .countdown-timer { display: block; }

            /* Horizontal Jet */
            .fuselage-wrapper { width: 100%; max-width: 1100px; height: 400px; }
            .fuselage-shell { width: 100%; height: 220px; flex-direction: row; border-radius: 90px 90px 90px 90px; align-self: center; box-shadow: inset 0 10px 20px rgba(0,0,0,0.1), inset 0 -10px 20px rgba(0,0,0,0.2), 0 20px 50px rgba(0,0,0,0.3); }
            .window-row-left { top: 8px; left: 160px; right: 120px; bottom: auto; width: auto; height: 8px; flex-direction: row; }
            .window-row-right { bottom: 8px; top: auto; left: 160px; right: 120px; width: auto; height: 8px; flex-direction: row; }
            .oval-window { width: 24px; height: 8px; }
            .cockpit-glass { width: 140px; height: 100%; align-items: center; justify-content: flex-end; padding-bottom: 0; padding-right: 20px; }
            .windshield { width: 40px; height: 60%; border-radius: 10px 40px 40px 10px; }
            .wing { top: 50%; transform: translateY(-50%); width: 300px; height: 500px; }
            .wing-left { left: auto; right: 250px; top: -140px; transform: skewX(-20deg) rotate(0deg); border-radius: 80px 10px 0 0; }
            .wing-right { right: 250px; left: auto; top: auto; bottom: -140px; transform: skewX(20deg) rotate(0deg); border-radius: 0 0 10px 80px; }
            .engine { bottom: auto; top: 50%; transform: translateY(-50%); width: 90px; height: 40px; }
            .engine-left { left: auto; right: 80px; top: 20px; transform: none; }
            .engine-right { left: auto; right: 80px; top: auto; bottom: 20px; transform: none; }
            .stabilizer { bottom: auto; top: 50%; transform: translateY(-50%); width: 60px; height: 180px; }
            .stab-left { left: auto; right: -20px; top: -50px; transform: skewX(-30deg); border-radius: 20px 5px 0 0; }
            .stab-right { right: -20px; left: auto; top: auto; bottom: -50px; transform: skewX(30deg); border-radius: 0 0 5px 20px; }
            .interior-layout { flex-direction: row; padding: 20px 100px 20px 150px; }
            
            .zone-1, .zone-2, .zone-3 { height: 100%; } .zone-1 { width: 30%; } .zone-2 { width: 35%; } .zone-3 { width: 35%; }
            .zone-1 .s1 { top: 20px; left: 10px; } .zone-1 .s2 { top: auto; bottom: 20px; left: 10px; } .zone-1 .s3 { top: 20px; left: 80px; } .zone-1 .s4 { top: auto; bottom: 20px; left: 80px; }
            .zone-2 .s1 { top: 20px; left: 20px; } .zone-2 .s2 { top: 20px; left: 90px; } .table { top: auto; bottom: 20px; left: 50px; width: 100px; height: 60px; writing-mode: horizontal-tb; } .credenza { top: 20px; bottom: auto; left: 150px; width: 40px; height: 180px; }
            .divan { bottom: 20px; left: 20px; top: auto; width: 160px; height: 50px; writing-mode: horizontal-tb; } .zone-3 .s1 { top: 20px; right: 60px; } .zone-3 .s2 { top: 20px; right: 130px; }

            /* Horizontal Yacht */
            .yacht-shell { width: 700px; height: 220px; flex-direction: row; border-radius: 120px 10px 10px 120px / 50% 10px 10px 50%; align-self: center; box-shadow: 0 0 0 10px rgba(255,255,255,0.05), 0 30px 60px rgba(0,0,0,0.4); }
            .teak-deck { border-radius: 110px 5px 5px 110px / 50% 5px 5px 50%; background: repeating-linear-gradient(0deg, rgba(139, 69, 19, 0.1), rgba(139, 69, 19, 0.1) 2px, transparent 2px, transparent 8px); }
            .bow-deck { width: 200px; height: 100%; border-right: 1px dashed var(--border-color); }
            .jacuzzi { top: 50%; left: 60px; transform: translateY(-50%); }
            .sunpad { top: 50%; left: 140px; transform: translateY(-50%) rotate(90deg); width: 80px; height: 40px; }
            .mid-deck { width: 250px; height: 100%; border-top: none; border-right: 1px dashed var(--border-color); }
            .dining-table-lg { top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100px; height: 140px; writing-mode: horizontal-tb; }
            .bar-area { top: 20px; right: 20px; bottom: auto; width: 60px; height: 40px; }
            .aft-deck { flex: 1; height: 100%; border-top: none; }
            .lounge-sofa { top: 20px; left: 20px; width: 120px; height: 40px; }
            .lounge-sofa.right { top: auto; bottom: 20px; left: 20px; right: auto; width: 120px; height: 40px; }
            
            .toy-grid { grid-template-columns: repeat(4, 1fr); }
            .env-controls { grid-template-columns: 1fr 1fr; }
        }
    </style>
</head>
<body class="mode-jet">

    <!-- Assignment Modal -->
    <div id="passenger-modal">
        <div class="modal-content">
            <h3 style="color: var(--primary-gold); margin-bottom: 10px;">Guest Assignment</h3>
            <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 10px;">Assign Guest Name</p>
            <input type="text" id="pax-name" class="modal-input" placeholder="e.g. Mr. Smith">
            <button class="modal-btn" onclick="savePassenger()">Confirm Assignment</button>
            <div style="margin-top: 15px; font-size: 0.8rem; color: var(--text-muted); cursor: pointer; text-decoration: underline;" onclick="closeModal()">Cancel</div>
        </div>
    </div>

    <div id="app-container" data-theme="dark">
        
        <!-- Sidebar -->
        <nav class="sidebar">
            <div class="brand-logo"><i class="fas fa-crown"></i></div>
            
            <div class="nav-item active" onclick="switchView('dashboard', this)">
                <i class="fas fa-chart-pie"></i>
            </div>
            <div class="nav-item" onclick="switchView('itinerary', this)">
                <i class="fas fa-list-ul"></i>
            </div>
            <div class="nav-item" onclick="switchView('dining', this)">
                <i class="fas fa-utensils"></i>
            </div>
            <div class="nav-item" onclick="switchView('seats', this)">
                <i class="fas fa-couch"></i>
            </div>
            
            <!-- Dark Mode Toggle -->
            <div class="nav-item" onclick="toggleTheme()" style="margin-top: auto;">
                <i class="fas fa-adjust"></i>
            </div>
        </nav>

        <!-- Header -->
        <header class="top-header">
            <div>
                <h2>Trip Dashboard</h2>
                <div class="leg-switcher">
                    <div class="leg-btn active" id="btn-jet" onclick="switchLeg('jet')"><i class="fas fa-plane"></i> Jet Leg</div>
                    <div class="leg-btn" id="btn-yacht" onclick="switchLeg('yacht')"><i class="fas fa-anchor"></i> Yacht Leg</div>
                </div>
            </div>
            <div id="countdown" class="countdown-timer">
                DEPARTURE IN 23D 04H 12M
            </div>
        </header>

        <!-- Main View -->
        <main id="view-container">

            <!-- DASHBOARD VIEW -->
            <div id="dashboard" class="view-section active-view">
                <div class="dashboard-grid">
                    
                    <!-- Map Card -->
                    <div class="card" style="grid-column: 1 / -1; padding: 0; border: none;">
                        <div id="map-container"></div>
                        <!-- Overlay Jet -->
                        <div class="show-jet" style="position: absolute; top: 20px; left: 20px; z-index: 500;">
                            <div style="background: var(--glass-bg); padding: 15px 20px; border-radius: 12px; backdrop-filter: blur(10px); border: 1px solid var(--border-color);">
                                <div class="uppercase-label">Flight Route</div>
                                <div style="font-size: 1.2rem; font-family: 'Playfair Display'; color: var(--text-main);">San Diego <span style="color:var(--primary-gold); margin:0 5px;">&#8594;</span> Ft. Lauderdale</div>
                            </div>
                        </div>
                        <!-- Overlay Yacht -->
                        <div class="show-yacht" style="position: absolute; top: 20px; left: 20px; z-index: 500;">
                            <div style="background: var(--glass-bg); padding: 15px 20px; border-radius: 12px; backdrop-filter: blur(10px); border: 1px solid var(--border-color);">
                                <div class="uppercase-label">Yacht Route</div>
                                <div style="font-size: 1.2rem; font-family: 'Playfair Display'; color: var(--text-main);">FLL <span style="color:var(--accent-blue); margin:0 5px;">~</span> Exumas</div>
                            </div>
                        </div>
                    </div>

                    <!-- Asset Info (Jet) -->
                    <div class="card show-jet">
                        <div class="uppercase-label">Aircraft</div>
                        <h3 style="margin-bottom: 20px;">Gulfstream G650ER</h3>
                        <div class="jet-hero aircraft-hero"></div>
                        <div style="display: flex; justify-content: space-between; border-top: 1px solid var(--border-color); padding-top: 20px;">
                            <div>
                                <div class="uppercase-label" style="color:var(--text-muted);">Range</div>
                                <div style="font-size: 1.1rem;">7,500 nm</div>
                            </div>
                            <div>
                                <div class="uppercase-label" style="color:var(--text-muted);">Speed</div>
                                <div style="font-size: 1.1rem;">Mach 0.925</div>
                            </div>
                            <div>
                                <div class="uppercase-label" style="color:var(--text-muted);">Pax</div>
                                <div style="font-size: 1.1rem;">16 Seats</div>
                            </div>
                        </div>
                    </div>

                    <!-- Asset Info (Yacht) -->
                    <div class="card show-yacht">
                        <div class="uppercase-label">Vessel</div>
                        <h3 style="margin-bottom: 20px;">M/Y ARTISAN</h3>
                        <div class="yacht-hero aircraft-hero">
                            <div class="tail-number">207' BENETTI</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; border-top: 1px solid var(--border-color); padding-top: 20px;">
                            <div>
                                <div class="uppercase-label" style="color:var(--text-muted);">Length</div>
                                <div style="font-size: 1.1rem;">63m (207')</div>
                            </div>
                            <div>
                                <div class="uppercase-label" style="color:var(--text-muted);">Builder</div>
                                <div style="font-size: 1.1rem;">Benetti</div>
                            </div>
                            <div>
                                <div class="uppercase-label" style="color:var(--text-muted);">Guests</div>
                                <div style="font-size: 1.1rem;">12 (7 Cabins)</div>
                            </div>
                        </div>
                    </div>

                    <!-- Crew Info -->
                    <div class="card">
                        <div class="uppercase-label show-jet">Flight Crew</div>
                        <div class="uppercase-label show-yacht">Yacht Crew</div>
                        <h3 style="margin-bottom: 20px;">Manifest</h3>
                        
                        <div class="show-jet">
                            <div class="crew-row">
                                <div class="crew-avatar"><i class="fas fa-user-tie"></i></div>
                                <div><div style="font-size: 1rem; font-weight: 600;">Capt. James Mitchell</div><div style="font-size: 0.8rem; color: var(--text-muted);">Pilot in Command</div></div>
                            </div>
                            <div class="crew-row">
                                <div class="crew-avatar"><i class="fas fa-user-shield"></i></div>
                                <div><div style="font-size: 1rem; font-weight: 600;">Michael Chang</div><div style="font-size: 0.8rem; color: var(--text-muted);">First Officer</div></div>
                            </div>
                            <div class="crew-row">
                                <div class="crew-avatar"><i class="fas fa-user"></i></div>
                                <div><div style="font-size: 1rem; font-weight: 600;">Sarah Jenkins</div><div style="font-size: 0.8rem; color: var(--text-muted);">Cabin Experience Lead</div></div>
                            </div>
                        </div>

                        <div class="show-yacht">
                            <div class="crew-row">
                                <div class="crew-avatar"><i class="fas fa-user-captain"></i></div>
                                <div><div style="font-size: 1rem; font-weight: 600;">Capt. Marcus Thorne</div><div style="font-size: 0.8rem; color: var(--text-muted);">Master</div></div>
                            </div>
                            <div class="crew-row">
                                <div class="crew-avatar"><i class="fas fa-utensils"></i></div>
                                <div><div style="font-size: 1rem; font-weight: 600;">Chef Elena Rossi</div><div style="font-size: 0.8rem; color: var(--text-muted);">Executive Chef</div></div>
                            </div>
                            <div class="crew-row">
                                <div class="crew-avatar"><i class="fas fa-concierge-bell"></i></div>
                                <div><div style="font-size: 1rem; font-weight: 600;">Chloe Davies</div><div style="font-size: 0.8rem; color: var(--text-muted);">Chief Stewardess</div></div>
                            </div>
                        </div>
                    </div>

                    <!-- Weather -->
                    <div class="card">
                        <div class="uppercase-label show-jet">Flight Conditions</div>
                        <div class="uppercase-label show-yacht">Sea State</div>
                        <h3 style="margin-bottom: 20px;">Forecast</h3>
                        
                        <div class="show-jet">
                            <div class="weather-row">
                                <div><div class="uppercase-label" style="color: var(--text-muted); margin-bottom: 2px;">San Diego</div><div style="font-family:'Playfair Display'; font-size: 1.1rem;">Clear Sky</div></div>
                                <div style="font-size: 1.8rem; font-weight: 300;">64°F</div>
                            </div>
                            <div class="weather-row">
                                <div><div class="uppercase-label" style="color: var(--text-muted); margin-bottom: 2px;">Ft. Lauderdale</div><div style="font-family:'Playfair Display'; font-size: 1.1rem;">Scattered Clouds</div></div>
                                <div style="font-size: 1.8rem; font-weight: 300;">78°F</div>
                            </div>
                        </div>

                        <div class="show-yacht">
                            <div class="weather-row">
                                <div><div class="uppercase-label" style="color: var(--text-muted); margin-bottom: 2px;">Exumas</div><div style="font-family:'Playfair Display'; font-size: 1.1rem;">Calm Seas</div></div>
                                <div style="font-size: 1.8rem; font-weight: 300;">84°F</div>
                            </div>
                            <div class="weather-row">
                                <div><div class="uppercase-label" style="color: var(--text-muted); margin-bottom: 2px;">Wind / Swell</div><div style="font-family:'Playfair Display'; font-size: 1.1rem;">E 10kts / 2ft</div></div>
                                <div style="font-size: 1.8rem; font-weight: 300;"><i class="fas fa-water"></i></div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>

            <!-- ITINERARY VIEW (Combined) -->
            <div id="itinerary" class="view-section">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px;">
                    <div>
                        <div class="uppercase-label">Full Trip</div>
                        <h2>Complete Schedule</h2>
                    </div>
                    <button style="padding: 10px 24px; background: transparent; border: 1px solid var(--text-muted); color: var(--text-main); border-radius: 30px; cursor: pointer; transition: 0.2s;">Download PDF</button>
                </div>
                
                <div class="card">
                    <div style="padding: 10px;">
                        
                        <!-- Flight Leg -->
                        <div style="margin-bottom: 10px; color: var(--text-muted); font-size: 0.8rem; font-weight: 700; text-transform: uppercase;">Dec 19 - The Flight</div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div>
                                <div class="timeline-time">09:00 AM</div>
                                <div class="timeline-title">Chauffeur Pickup</div>
                                <div class="timeline-sub">Cadillac Escalade | Driver: Michael | San Diego, CA</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot" style="background: var(--primary-gold);"></div>
                            <div>
                                <div class="timeline-time">09:45 AM</div>
                                <div class="timeline-title">Wheels Up (G650ER)</div>
                                <div class="timeline-sub">Direct to FLL | Flight Time: 4h 35m</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot"></div>
                            <div>
                                <div class="timeline-time">05:20 PM EST</div>
                                <div class="timeline-title">Arrival FLL</div>
                                <div class="timeline-sub">Transfer to Marina via Helicopter/Limo</div>
                            </div>
                        </div>

                        <!-- Yacht Leg -->
                        <div style="margin: 30px 0 10px 0; color: var(--text-muted); font-size: 0.8rem; font-weight: 700; text-transform: uppercase;">Dec 19 - Dec 26 - The Yacht</div>
                        <div class="timeline-item">
                            <div class="timeline-dot" style="border-color: var(--accent-blue);"></div>
                            <div>
                                <div class="timeline-time">06:30 PM</div>
                                <div class="timeline-title">Welcome Aboard M/Y ARTISAN</div>
                                <div class="timeline-sub">Sunset Cocktails & Departure to Nassau</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot" style="border-color: var(--accent-blue);"></div>
                            <div>
                                <div class="timeline-time">Dec 20</div>
                                <div class="timeline-title">Atlantis & Paradise Island</div>
                                <div class="timeline-sub">Dockage at Atlantis Marina. Evening Casino Night & Fine Dining.</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot" style="border-color: var(--accent-blue);"></div>
                            <div>
                                <div class="timeline-time">Dec 22</div>
                                <div class="timeline-title">Exumas - Pig Beach</div>
                                <div class="timeline-sub">Cruise to Big Major Cay. Swimming with the pigs excursion.</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot" style="border-color: var(--accent-blue);"></div>
                            <div>
                                <div class="timeline-time">Dec 23</div>
                                <div class="timeline-title">Thunderball Grotto</div>
                                <div class="timeline-sub">Snorkeling the famous 007 underwater cave system. Seabob session.</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot" style="border-color: var(--accent-blue);"></div>
                            <div>
                                <div class="timeline-time">Dec 24</div>
                                <div class="timeline-title">Compass Cay</div>
                                <div class="timeline-sub">Swimming with Nurse Sharks. Highbourne Cay Marina for Christmas Eve dinner.</div>
                            </div>
                        </div>
                        <div class="timeline-item">
                            <div class="timeline-dot" style="border-color: var(--accent-blue);"></div>
                            <div>
                                <div class="timeline-time">Dec 26</div>
                                <div class="timeline-title">Disembarkation</div>
                                <div class="timeline-sub">11:00 AM | Nassau or FLL (Weather dependent)</div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>

            <!-- DINING VIEW -->
            <div id="dining" class="view-section">
                <div style="margin-bottom: 30px;">
                    <div class="uppercase-label show-jet">In-Flight Service</div>
                    <div class="uppercase-label show-yacht">On-Deck Service</div>
                    <h2>Provisioning</h2>
                </div>

                <div class="card">
                    <!-- JET MENU -->
                    <div class="show-jet">
                        <h3 style="margin-bottom: 30px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px;">A La Carte (Jet)</h3>
                        <div class="provisioning-group">
                            <div class="uppercase-label">Top Shelf Spirits</div>
                            <div class="multi-select-container">
                                <div class="select-option" onclick="toggleOption(this)">Clase Azul Reposado</div>
                                <div class="select-option" onclick="toggleOption(this)">Don Julio 1942</div>
                                <div class="select-option" onclick="toggleOption(this)">Macallan 18 Year</div>
                                <div class="select-option" onclick="toggleOption(this)">Johnny Walker Blue</div>
                            </div>
                        </div>
                        <div class="provisioning-group">
                            <div class="uppercase-label">Entree Preference</div>
                            <div class="multi-select-container">
                                 <div class="select-option" onclick="toggleOption(this)">Wagyu Sliders</div>
                                 <div class="select-option" onclick="toggleOption(this)">Poached Lobster</div>
                                 <div class="select-option" onclick="toggleOption(this)">Miso Seabass</div>
                                 <div class="select-option" onclick="toggleOption(this)">Filet Mignon</div>
                            </div>
                        </div>
                    </div>

                    <!-- YACHT MENU -->
                    <div class="show-yacht">
                        <h3 style="margin-bottom: 30px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px;">Chef's Table (Yacht)</h3>
                        <div class="provisioning-group">
                            <div class="uppercase-label">Sun Deck Bar</div>
                            <div class="multi-select-container">
                                <div class="select-option" onclick="toggleOption(this)">Mojito Pitchers</div>
                                <div class="select-option" onclick="toggleOption(this)">Spicy Margaritas</div>
                                <div class="select-option" onclick="toggleOption(this)">Whispering Angel Rose</div>
                                <div class="select-option" onclick="toggleOption(this)">Aperol Spritz</div>
                                <div class="select-option" onclick="toggleOption(this)">Local Kalik Beer</div>
                            </div>
                        </div>
                        <div class="provisioning-group">
                            <div class="uppercase-label">Fresh Catch Selection</div>
                            <div class="multi-select-container">
                                <div class="select-option" onclick="toggleOption(this)">Local Lobster</div>
                                <div class="select-option" onclick="toggleOption(this)">Stone Crabs</div>
                                <div class="select-option" onclick="toggleOption(this)">Mahi Mahi</div>
                                <div class="select-option" onclick="toggleOption(this)">Grouper</div>
                                <div class="select-option" onclick="toggleOption(this)">Tuna Sashimi</div>
                            </div>
                        </div>
                        <div class="provisioning-group">
                            <div class="uppercase-label">Breakfast Style</div>
                            <div class="multi-select-container">
                                 <div class="select-option" onclick="toggleOption(this)">Continental</div>
                                 <div class="select-option" onclick="toggleOption(this)">American Full</div>
                                 <div class="select-option" onclick="toggleOption(this)">Healthy / Acai</div>
                                 <div class="select-option" onclick="toggleOption(this)">Buffet</div>
                            </div>
                        </div>
                    </div>

                    <div class="provisioning-group">
                         <div class="uppercase-label">Special Requests / Allergies</div>
                         <input type="text" class="custom-input" placeholder="E.g. No gluten, extra lemons...">
                    </div>
                </div>
            </div>

            <!-- SEATS/LAYOUT VIEW -->
            <div id="seats" class="view-section">
                <div style="margin-bottom: 30px;">
                    <div class="uppercase-label">Arrangement</div>
                    <h2 class="show-jet">Cabin Configuration</h2>
                    <h2 class="show-yacht">Sun Deck & Toy Garage</h2>
                </div>
                
                <div class="card" style="margin-bottom: 30px; margin-top:10px; overflow:visible; border:none; background:transparent; box-shadow:none; padding:0;">
                    <div class="blueprint-container">
                        <div class="fuselage-wrapper">
                            
                            <!-- JET UI -->
                            <div class="show-jet show-jet-flex"> 
                                <div class="wing wing-left"></div><div class="wing wing-right"></div>
                                <div class="engine engine-left"></div><div class="engine engine-right"></div>
                                <div class="stabilizer stab-left"></div><div class="stabilizer stab-right"></div>

                                <div class="fuselage-shell" id="fuselage-jet">
                                    <div class="cockpit-glass"><div class="windshield"></div></div>
                                    <div class="window-row-left"><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div></div>
                                    <div class="window-row-right"><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div><div class="oval-window"></div></div>
                                    
                                    <div class="interior-layout">
                                        <div class="zone zone-1">
                                            <div class="zone-label">CLUB</div>
                                            <div class="seat s1" onclick="openSeat(this)">1A</div><div class="seat s2" onclick="openSeat(this)">1B</div>
                                            <div class="seat s3" onclick="openSeat(this)">2A</div><div class="seat s4" onclick="openSeat(this)">2B</div>
                                        </div>
                                        <div class="zone zone-2">
                                            <div class="zone-label">CONF</div>
                                            <div class="seat s1" onclick="openSeat(this)">3A</div><div class="seat s2" onclick="openSeat(this)">3B</div>
                                            <div class="table">DINING</div><div class="credenza"></div>
                                        </div>
                                        <div class="zone zone-3">
                                            <div class="zone-label">SUITE</div>
                                            <div class="seat s1" onclick="openSeat(this)">4A</div><div class="seat s2" onclick="openSeat(this)">4B</div>
                                            <div class="divan">DIVAN</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- YACHT UI -->
                            <div class="yacht-shell show-yacht" id="fuselage-yacht">
                                <div class="teak-deck"></div>
                                <div class="deck-zone bow-deck">
                                    <div class="jacuzzi"><i class="fas fa-water"></i></div>
                                    <div class="sunpad"></div>
                                </div>
                                <div class="deck-zone mid-deck">
                                    <div class="dining-table-lg">AL FRESCO</div>
                                    <div class="bar-area"></div>
                                </div>
                                <div class="deck-zone aft-deck">
                                    <div class="lounge-sofa"></div><div class="lounge-sofa right"></div>
                                    <div class="swim-platform-stairs"></div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

                <!-- TOY BOX (Yacht Only) -->
                <div class="show-yacht">
                    <div class="card">
                        <h3 style="margin-bottom: 20px;">Toys & Tenders</h3>
                        <div class="toy-grid">
                            <div class="toy-card">
                                <div class="toy-icon"><i class="fas fa-ship"></i></div>
                                <div class="toy-name">44' Fjord Open</div>
                                <div class="toy-sub">Chase Boat</div>
                            </div>
                            <div class="toy-card">
                                <div class="toy-icon"><i class="fas fa-bolt"></i></div>
                                <div class="toy-name">2x Seadoo GTX</div>
                                <div class="toy-sub">300 Limited</div>
                            </div>
                            <div class="toy-card">
                                <div class="toy-icon"><i class="fas fa-water"></i></div>
                                <div class="toy-name">3x Seabobs</div>
                                <div class="toy-sub">F5S Underwater</div>
                            </div>
                            <div class="toy-card">
                                <div class="toy-icon"><i class="fas fa-wind"></i></div>
                                <div class="toy-name">Lift3 eFoil</div>
                                <div class="toy-sub">Electric Surf</div>
                            </div>
                            <div class="toy-card">
                                <div class="toy-icon"><i class="fas fa-swimmer"></i></div>
                                <div class="toy-name">Inflatable Park</div>
                                <div class="toy-sub">Jungle Jim + Slide</div>
                            </div>
                            <div class="toy-card">
                                <div class="toy-icon"><i class="fas fa-biking"></i></div>
                                <div class="toy-name">Castoldi Jet</div>
                                <div class="toy-sub">25' Yanmar</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Environment Controls -->
                <div class="env-controls">
                    <div class="control-box">
                        <div class="control-label show-jet"><i class="fas fa-lightbulb"></i> Ambient Mood</div>
                        <div class="control-label show-yacht"><i class="fas fa-lightbulb"></i> Underwater Lights</div>
                        <div class="mood-grid">
                            <div class="mood-btn" style="background: #ffffff; box-shadow: 0 0 10px #ffffff;" onclick="setMood(this, 'rgba(255, 255, 255, 0.4)')" title="Daylight"></div>
                            <div class="mood-btn" style="background: #ff9f1c; box-shadow: 0 0 10px #ff9f1c;" onclick="setMood(this, 'rgba(255, 159, 28, 0.4)')" title="Warm"></div>
                            <div class="mood-btn" style="background: #e6af2e; box-shadow: 0 0 10px #e6af2e;" onclick="setMood(this, 'rgba(230, 175, 46, 0.4)')" title="Candle"></div>
                            <div class="mood-btn" style="background: #ff6b6b; box-shadow: 0 0 10px #ff6b6b;" onclick="setMood(this, 'rgba(255, 107, 107, 0.4)')" title="Sunset"></div>
                            <div class="mood-btn" style="background: #d90368; box-shadow: 0 0 10px #d90368;" onclick="setMood(this, 'rgba(217, 3, 104, 0.4)')" title="Magenta"></div>
                            <div class="mood-btn" style="background: #8338ec; box-shadow: 0 0 10px #8338ec;" onclick="setMood(this, 'rgba(131, 56, 236, 0.4)')" title="Neon Purple"></div>
                            <div class="mood-btn" style="background: #3a86ff; box-shadow: 0 0 10px #3a86ff;" onclick="setMood(this, 'rgba(58, 134, 255, 0.4)')" title="Deep Ocean"></div>
                            <div class="mood-btn" style="background: #2ec4b6; box-shadow: 0 0 10px #2ec4b6;" onclick="setMood(this, 'rgba(46, 196, 182, 0.4)')" title="Cyan"></div>
                            <div class="mood-btn" style="background: #008080; box-shadow: 0 0 10px #008080;" onclick="setMood(this, 'rgba(0, 128, 128, 0.4)')" title="Teal"></div>
                            <div class="mood-btn" style="background: #70e000; box-shadow: 0 0 10px #70e000;" onclick="setMood(this, 'rgba(112, 224, 0, 0.4)')" title="Lime"></div>
                            <div class="mood-btn" style="background: #00ff00; box-shadow: 0 0 10px #00ff00;" onclick="setMood(this, 'rgba(0, 255, 0, 0.4)')" title="Matrix"></div>
                            <div class="mood-btn" style="background: #d00000; box-shadow: 0 0 10px #d00000;" onclick="setMood(this, 'rgba(208, 0, 0, 0.4)')" title="Crimson"></div>
                        </div>
                    </div>

                    <div class="control-box">
                        <div class="control-label"><i class="fas fa-music"></i> Audio Ambience</div>
                        <div class="multi-select-container show-jet" style="justify-content: center;">
                            <div class="select-option" onclick="toggleOption(this)">Jazz</div>
                            <div class="select-option" onclick="toggleOption(this)">Lo-Fi</div>
                            <div class="select-option" onclick="toggleOption(this)">Classical</div>
                        </div>
                        <div class="multi-select-container show-yacht" style="justify-content: center;">
                            <div class="select-option" onclick="toggleOption(this)">Party Mode</div>
                            <div class="select-option" onclick="toggleOption(this)">Chill House</div>
                            <div class="select-option" onclick="toggleOption(this)">Lounge</div>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // 1. Navigation Logic
        function switchView(viewId, navElement) {
            document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
            if(navElement) navElement.classList.add('active');
            
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view'));
            const target = document.getElementById(viewId);
            target.classList.add('active-view');

            if(viewId === 'dashboard' && map) {
                setTimeout(() => { map.invalidateSize(); }, 100);
            }
        }

        // 2. Leg Switching Logic
        let currentLeg = 'jet';

        function switchLeg(leg) {
            currentLeg = leg;
            document.querySelectorAll('.leg-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById(`btn-${leg}`).classList.add('active');
            
            // Toggle body class for CSS logic
            if(leg === 'yacht') {
                document.body.classList.remove('mode-jet');
                document.body.classList.add('mode-yacht');
                updateMapForYacht();
            } else {
                document.body.classList.remove('mode-yacht');
                document.body.classList.add('mode-jet');
                updateMapForJet();
            }
        }

        // 3. Leaflet Map Logic
        let map;
        let vehicleMarker;
        let polyline;
        
        // Coordinates
        const san = [32.7338, -117.1933];
        const fll = [26.0726, -80.1527];
        const exumas = [24.1800, -76.4500];

        // SVGs
        const jetSvg = `<svg viewBox="0 0 500 500" style="filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5)); display:block; width:100%; height:100%;"><path d="M220 230 L50 380 L80 400 L240 280 Z" fill="#e0e0e0" stroke="#ccc" /><path d="M220 230 L50 380 L60 380 L220 240 Z" fill="#111" /><path d="M50 380 L80 400 L70 360 Z" fill="#C5A059" /><path d="M280 230 L450 380 L420 400 L260 280 Z" fill="#e0e0e0" stroke="#ccc" /><path d="M280 230 L450 380 L440 380 L280 240 Z" fill="#111" /><path d="M450 380 L420 400 L430 360 Z" fill="#C5A059" /><path d="M210 360 L210 420 Q225 425 240 420 L240 360 Q225 355 210 360" fill="#eee" stroke="#ccc" /><path d="M290 360 L290 420 Q275 425 260 420 L260 360 Q275 355 290 360" fill="#eee" stroke="#ccc" /><path d="M250 40 Q290 150 270 480 L230 480 Q210 150 250 40 Z" fill="url(#fuselageGrad)" stroke="#bbb" stroke-width="0.5"/><path d="M235 90 Q250 80 265 90 Q265 100 250 105 Q235 100 235 90 Z" fill="#1a1a1a" /><path d="M250 430 L170 490 L330 490 L250 430 Z" fill="#e0e0e0" stroke="#ccc" /><path d="M170 490 L190 490 L180 470 Z" fill="#C5A059" /><path d="M330 490 L310 490 L320 470 Z" fill="#C5A059" /></svg>`;
        
        const yachtSvg = `<svg viewBox="0 0 512 512" fill="#C5A059" style="filter: drop-shadow(0 4px 6px rgba(0,0,0,0.5)); display:block; width:100%; height:100%;"><path d="M100 350 L412 350 L450 300 L60 300 Z" /><path d="M120 300 L400 300 L380 250 L140 250 Z" opacity="0.8" /><path d="M160 250 L360 250 L350 200 L170 200 Z" opacity="0.6" /><path d="M220 200 L300 200 L290 170 L230 170 Z" opacity="0.4" /></svg>`;

        function initMap() {
            map = L.map('map-container', { zoomControl: false, attributionControl: false, dragging: false, scrollWheelZoom: false });
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { subdomains: 'abcd', maxZoom: 19 }).addTo(map);
            
            // Init with Jet
            updateMapForJet();
        }

        let animInterval;

        function updateMapForJet() {
            if(polyline) map.removeLayer(polyline);
            if(vehicleMarker) map.removeLayer(vehicleMarker);
            clearInterval(animInterval);

            map.setView([32.0, -98.0], 4);
            
            polyline = L.polyline([san, fll], { color: '#C5A059', weight: 1.5, opacity: 0.6, dashArray: '4, 8' }).addTo(map);
            
            const icon = L.divIcon({ className: 'plane-marker', html: jetSvg, iconSize: [48, 48], iconAnchor: [24, 24] });
            vehicleMarker = L.marker(san, {icon: icon}).addTo(map);

            let p = 0;
            animInterval = setInterval(() => {
                p += 0.001; if(p > 1) p = 0;
                const lat = san[0] + (fll[0] - san[0]) * p;
                const lng = san[1] + (fll[1] - san[1]) * p;
                vehicleMarker.setLatLng([lat, lng]);
                const el = document.querySelector('.plane-marker svg');
                if(el) el.style.transform = `rotate(90deg) rotateX(${Math.sin(p*10)*5}deg)`;
            }, 20);
        }

        function updateMapForYacht() {
            if(polyline) map.removeLayer(polyline);
            if(vehicleMarker) map.removeLayer(vehicleMarker);
            clearInterval(animInterval);

            map.setView([25.0, -78.0], 7);

            polyline = L.polyline([fll, exumas], { color: '#2E86AB', weight: 2, opacity: 0.8, dashArray: '5, 10' }).addTo(map);
            
            const icon = L.divIcon({ className: 'plane-marker', html: yachtSvg, iconSize: [40, 40], iconAnchor: [20, 20] });
            vehicleMarker = L.marker(fll, {icon: icon}).addTo(map);

            let p = 0;
            animInterval = setInterval(() => {
                p += 0.0005; if(p > 1) p = 0;
                const lat = fll[0] + (exumas[0] - fll[0]) * p;
                const lng = fll[1] + (exumas[1] - fll[1]) * p;
                vehicleMarker.setLatLng([lat, lng]);
            }, 30);
        }

        // 4. Passenger Logic
        let currentSeat = null;
        function openSeat(el) { currentSeat = el; document.getElementById('passenger-modal').style.display = 'flex'; }
        function closeModal() { document.getElementById('passenger-modal').style.display = 'none'; currentSeat = null; }
        function savePassenger() {
            if(currentSeat) {
                currentSeat.classList.add('assigned');
                // If yacht hotspot, change icon
                if(currentSeat.classList.contains('hotspot')) {
                    currentSeat.innerHTML = '<i class="fas fa-check"></i>';
                    currentSeat.style.background = 'var(--accent-blue)';
                    currentSeat.style.color = '#fff';
                    currentSeat.style.animation = 'none';
                    currentSeat.style.boxShadow = 'none';
                }
            }
            closeModal();
        }

        // 5. Mood Logic
        function setMood(element, color) {
            document.querySelectorAll('.mood-btn').forEach(btn => btn.classList.remove('selected'));
            element.classList.add('selected');
            
            const target = currentLeg === 'jet' ? document.getElementById('fuselage-jet') : document.getElementById('fuselage-yacht');
            if(target) {
                if(currentLeg === 'jet') {
                    target.style.boxShadow = `inset 0 0 100px ${color}, inset 10px 0 20px rgba(0,0,0,0.1), inset -10px 0 20px rgba(0,0,0,0.2)`;
                } else {
                    target.style.boxShadow = `0 0 50px 10px ${color}`;
                }
            }
        }

        // 6. Theme Logic
        function toggleOption(el) { el.classList.toggle('selected'); }
        function toggleTheme() {
            const app = document.getElementById('app-container');
            if(app.getAttribute('data-theme') === 'dark') {
                app.setAttribute('data-theme', 'light');
            } else {
                app.setAttribute('data-theme', 'dark');
            }
        }

        // Initialize
        window.onload = function() {
            initMap();
        };

    </script>
</body>
</html>
